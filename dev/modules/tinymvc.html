<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script src="tinymvc.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPhp.min.js"></script>
	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreDefault.min.css" />
</head>
<body>
	<h1>View Terminal to see what happened.</h1>
	<h1>View Page Source to see the code. (It's simple)</h1>
	<br>
	<button id="click">Click Me!</button>
	<br>
	<button id="one">URL 1</button>
	<button id="two">URL 2</button>
	<button id="three">URL 3</button>
	<script>
		/*Example :D*/
		Model.create({
			test: 'dddd',
			workspace: { //Models are just JSON so Collections are just objects :D
				documents: { 
					attributes: {
						title: null
					},
					getSomething: function(){
						return 12;
					}
				}
			},
			color: 'red',
			buttonHasBeenClicked: false
		});
		//following function will execute each time Model.modify() is called
		//name = name of last modified | val = value of last modified | states = previous values | count = number of times function has ran
		View.create(function(name, val, states, count, model){ //"model" = Model.data :)
			switch(name){
				case 'test':
					console.log('test changed to ' + val);
					break;
				//you can reference next level with hyphen
				case 'workspace-documents-attributes-title':
					console.log('changed title to: ' + val);
					break;
				case 'buttonHasBeenClicked':
				 	//getting the most recently changed name
					alert('You clicked the button! Model.lastChanged = "' + Model.lastChanged + '"');
					//get previous states of a model var
					console.log("First state of " + name + " is " + states[0] + " and most recent state is: " + states[states.length - 1]);
					break;
				case 'something':
					alert('fff');
			}
			if(count === 0){ //do first time this function runs only
				//all do the exact same thing, running a function from a collection
				console.log(Model.get('workspace-documents').getSomething());
				console.log(model.workspace.documents.getSomething());
				console.log(Model.get(['workspace', 'documents']).getSomething());
			}
		});
		//Controller doesnt do much, yet
		Controller.create(function(model){
			if(Model.data.color === model.color) Model.modify('test', true); //tel the view what you changed with modify
			if(model.color === 'red') Model.modify('test', false);
			//you can add/change Model data without telling the View
			model.something = 'value';
			//or
			Model.modify('something', 'value', false); //false means dont notify, cascade() has this too
			//may be more comfortable to get data with tinyMVC syntax (arrays or hyphens) :)
			var something = Model.get('workspace-documents-attributes-title');
			var something = model.workspace.documents.attributes.title; //works as well
			//you can always use either an array or hyphens, your choice
			Model.modify(['workspace', 'documents', 'attributes', 'title'], 'Array test'); //works!
			Model.modify('workspace-documents-attributes-title', 'Hyphen test'); //works!
			Model.cascade({ //modify multiple things at once
				'workspace-documents-attributes-title': 'Changing multiple vars!',
				'test': true
			});
			//a more practical example
			$(document).on('click', '#click', function(){
				var bool = (model.buttonHasBeenClicked) ? false : true;
				Model.modify('buttonHasBeenClicked', bool);
			});
			$(document).on('click', '#one', function(){
				Router.goTo('url1');
			});
			$(document).on('click', '#two', function(){
				Router.goTo('url2');
			});
			$(document).on('click', '#three', function(){
				Router.goTo('url3');
			});
		});
		//following function will run each time Router.goTo() is called, hash is changed, and/or refresh/back fwd buttons
		Router.create(function(url, count){ //current url minus hash | number of times func has ran
			//take url as parameter and call with Router.goTo()
			console.log(Router.hash('visible')); //is there a hash present?
			var hash = Router.hash(); //outputs #!/...
			console.log('url: ' + url);
				switch(url){
					case 'url1':
						console.log("Welcome to page 1.");
						break;
					case 'url2':
						console.log("Welcome to page 2.");
						break;
					case 'url3':
						console.log("Welcome to page 3.");
						break;
				}
				console.log(count);
		});
		//Router.run(); //to run function for current url (to handle refresh)
		//finally, to get the current Model
		var savedModel = Model.retrieve();
		//alert(JSON.stringify(savedModel));
	</script>
</body>
</html>